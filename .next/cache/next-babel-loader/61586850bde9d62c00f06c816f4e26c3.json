{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\nimport Wrapper from \"../../components/layout/wrapper\";\nimport { Button } from \"../../components/button\";\nimport { asyncFetch } from \"../../components/fetchHelper\";\nimport Router, { useRouter } from \"next/router\";\nimport styled from \"styled-components\";\nimport { ContainerActivityDetail } from \"../../components/layout/container\";\nimport React from \"react\";\nimport Skeleton from \"../../components/skeleton\";\nimport dynamic from \"next/dynamic\";\nimport moment from \"moment\";\nimport { SummaryCard } from \"../../components/activity-detail/summary-card\";\nimport { AuthContext } from \"../_app\";\nimport RenderLineChart from \"../../components/activityCharts\";\nvar MetaDescription = styled.p.withConfig({\n  displayName: \"activity__MetaDescription\",\n  componentId: \"sc-5yd8zt-0\"\n})([\"opacity:0.5;margin:0;\"]);\nvar PageHeader = styled.h3.withConfig({\n  displayName: \"activity__PageHeader\",\n  componentId: \"sc-5yd8zt-1\"\n})([\"margin-top:\", \";margin-bottom:\", \";\"], function (props) {\n  return props.theme.tokens.spacing.L.value;\n}, function (props) {\n  return props.theme.tokens.spacing.M.value;\n});\nvar ActivityDetailLongScroll = styled.div.withConfig({\n  displayName: \"activity__ActivityDetailLongScroll\",\n  componentId: \"sc-5yd8zt-2\"\n})([\"padding:\", \";padding-top:100px;max-width:1024px;@media (max-width:\", \"){padding:\", \";padding-top:100px;}\"], function (props) {\n  return props.theme.tokens.spacing.XL.value;\n}, function (props) {\n  return props.theme.tokens.mediaQueries.small;\n}, function (props) {\n  return props.theme.tokens.spacing.L.value;\n});\nvar DynamicMapboxLargeComponent = dynamic(function () {\n  return import(\"../../components/activityDetailMap\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../../components/activityDetailMap\")];\n    },\n    modules: [\"../../components/activityDetailMap\"]\n  }\n});\nvar DynamicMapboxSmallComponent = dynamic(function () {\n  return import(\"../../components/activityDetailMapMini\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"../../components/activityDetailMapMini\")];\n    },\n    modules: [\"../../components/activityDetailMapMini\"]\n  }\n});\nvar LargeMapContainer = styled.div.withConfig({\n  displayName: \"activity__LargeMapContainer\",\n  componentId: \"sc-5yd8zt-3\"\n})([\"display:block;width:100%;height:100%;position:relative;@media (max-width:\", \"){display:none;}\"], function (props) {\n  return props.theme.tokens.mediaQueries.small;\n});\nvar SmallMapContainer = styled.div.withConfig({\n  displayName: \"activity__SmallMapContainer\",\n  componentId: \"sc-5yd8zt-4\"\n})([\"width:100%;height:100%;position:relative;display:none;margin-top:\", \";margin-bottom:\", \";border-radius:\", \";overflow:hidden;@media (max-width:\", \"){display:block;}\"], function (props) {\n  return props.theme.tokens.spacing.L.value;\n}, function (props) {\n  return props.theme.tokens.spacing.L.value;\n}, function (props) {\n  return props.theme.tokens.borderRadius.value;\n}, function (props) {\n  return props.theme.tokens.mediaQueries.small;\n});\n\nvar ActivityDetail = function ActivityDetail(props) {\n  var router = useRouter();\n  var activity = router.query.activity;\n\n  var _React$useState = React.useState(true),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      loading = _React$useState2[0],\n      setLoading = _React$useState2[1];\n\n  var _React$useState3 = React.useState([]),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      activitySummary = _React$useState4[0],\n      setActivitySummary = _React$useState4[1];\n\n  var _React$useState5 = React.useState([]),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      activityStream = _React$useState6[0],\n      setActivityStream = _React$useState6[1];\n\n  var value = React.useContext(AuthContext);\n  var cookies = value.cookies;\n  var currentTime = Date.now() / 1000;\n  var access_token = cookies.access_token;\n  var expires_at = cookies.expires_at;\n  React.useEffect(function () {\n    var activityFetchUrl = \"https://www.strava.com/api/v3/activities/\" + activity;\n    var activityStreamFetchUrl = activityFetchUrl + \"/streams/watts,altitude,heartrate,latlng,cadence,velocity_smooth?resolution=low\";\n    var fetchUrls = [activityFetchUrl, activityStreamFetchUrl];\n    Promise.all(fetchUrls.map(function (url) {\n      return fetch(url, {\n        method: \"get\",\n        headers: {\n          \"content-type\": \"application/json\",\n          authorization: \"Bearer \" + access_token\n        }\n      });\n    })).then(function (responses) {\n      return Promise.all(responses.map(function (res) {\n        return res.json();\n      }));\n    }).then(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n          summary = _ref2[0],\n          stream = _ref2[1];\n\n      setActivitySummary(summary);\n      setActivityStream(stream);\n      setLoading(false);\n    });\n  }, [value]);\n  var activityStartTime = moment(activitySummary.start_date_local);\n  var friendlyFormat = activityStartTime.format(\"MMM Do YYYY [at] h:mm a\");\n  return __jsx(Wrapper, {\n    props: props\n  }, __jsx(ContainerActivityDetail, null, __jsx(ActivityDetailLongScroll, null, loading ? __jsx(Skeleton, null) : __jsx(\"div\", null, __jsx(Button, {\n    onClick: function onClick() {\n      Router.back();\n    },\n    label: \"‚Üê Back\"\n  }), __jsx(PageHeader, null, activitySummary.name), __jsx(MetaDescription, null, friendlyFormat), __jsx(\"p\", null, activitySummary.description), activitySummary.start_latlng ? __jsx(SmallMapContainer, null, __jsx(DynamicMapboxSmallComponent, {\n    activitySummary: activitySummary\n  })) : __jsx(\"div\", null), __jsx(RenderLineChart, {\n    data: activityStream\n  }), __jsx(SummaryCard, {\n    activitySummary: activitySummary\n  }))), activitySummary.start_latlng ? __jsx(LargeMapContainer, null, __jsx(DynamicMapboxLargeComponent, {\n    activitySummary: activitySummary\n  })) : __jsx(\"div\", null)));\n};\n\nexport default ActivityDetail;","map":null,"metadata":{},"sourceType":"module"}