{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\n// import React from \"react\";\n// import Router, { useRouter } from \"next/router\";\n// import styled from \"styled-components\";\n// import Link from \"next/link\";\n// import Wrapper from \"../components/layout/wrapper\";\n// let Container = styled.div`\n//   background-color: ${props => props.theme.colors.background};\n//   padding: ${props => props.theme.tokens.spacing.XXL.value};\n//   grid-column-start: 2;\n//   grid-column-end: 3;\n//   grid-row-start: 2;\n//   grid-row-end: 3;\n//   @media (max-width: ${props => props.theme.tokens.mediaQueries.small}) {\n//     max-width: ${props => props.theme.tokens.mediaQueries.small};\n//     place-self: center;\n//     padding: ${props => props.theme.tokens.spacing.L.value};\n//     grid-column-start: 1;\n//     grid-column-end: 4;\n//   }\n// `;\n// const Home = props => {\n//   const { auth } = props;\n//   if (auth) {\n//     //\n//   } else {\n//     // Router.push(\"/\");\n//   }\n//   // React.useEffect(() => {\n//   //   if (auth) {\n//   //     console.log(\"HOME: logged in\");\n//   //     Router.push(\"/activities\");\n//   //   } else {\n//   //     console.log(\"HOME: logged out\");\n//   //   }\n//   // }, [auth]);\n//   return (\n//     <Wrapper>\n//       <Container>\n//         <h1>Header 1</h1>\n//         <Link href=\"/activities/2712024607\">\n//           <a>Activity Detail</a>\n//         </Link>\n//         <br />\n//         <Link href=\"/test/[test]\" as=\"/test/abc/\">\n//           <a>Test Link</a>\n//         </Link>\n//         <h5>https://www.cram.com/essay/the-banana-plant/P3CJMRN2AC</h5>\n//         <p>\n//           Bananas are the fruit of a plant of the genus Musa, which are\n//           cultivated primarily for food, and secondarily for the production of\n//           fibers. It is alleged that there are almost 1000 varieties of bananas\n//           in the world, subdivided in 50 groups (Bora, 2007). The most generally\n//           known banana is the seedless Cavendish variety, which is the one\n//           produced for export markets and pronounced for consuming.\n//         </p>\n//         <h2>Header 2</h2>\n//         <p>\n//           The banana is the fruit of an herbaceous plant related to the orchid\n//           family and is most commonly found in tropical climate areas which\n//           become an exotic product of cold environment zones.\n//         </p>\n//         <h3>Header 3</h3>\n//         <p>\n//           The banana is believed to have originated in Southeast Asia and\n//           Malaysia, and cultivation could have started as early as 8000 BCE. The\n//           professionals believe that\n//         </p>\n//         <h4>Header 4</h4>\n//         <h5>Eyebrow</h5>\n//         <p>Musa sapientum</p>\n//         <span>Musa sapientum</span>\n//       </Container>\n//     </Wrapper>\n//   );\n// };\n// export default Home;\nimport Wrapper from \"../components/layout/wrapper\";\nimport fetch from \"isomorphic-unfetch\";\nimport React from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport styled from \"styled-components\";\nimport ActivityCard from \"../components/activity-card\";\nimport { AuthContext } from \"./_app\";\nimport Router, { useRouter } from \"next/router\";\nimport Skeleton from \"../components/skeleton\";\nimport { Container } from \"../components/layout/container\";\nimport { PageHeader } from \"../components/pageHeader\";\nimport SubNav from \"../components/subnav\";\nimport Link from \"next/link\";\nimport { Button } from \"../components/button\";\nvar ActivitiesGrid = styled.div.withConfig({\n  displayName: \"pages__ActivitiesGrid\",\n  componentId: \"sc-38y5yx-0\"\n})([\"display:grid;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));grid-gap:\", \";@media (max-width:\", \"){grid-template-columns:1fr;}\"], function (props) {\n  return props.theme.tokens.spacing.L.value;\n}, function (props) {\n  return props.theme.tokens.mediaQueries.small;\n});\nvar activitiesFetchUrl;\n\nvar Activities = function Activities(props) {\n  // const { cookies } = props;\n  var router = useRouter();\n  var page = router.query.page;\n  var auth = props.auth;\n  var value = React.useContext(AuthContext);\n  var cookies = value.cookies;\n  console.log(auth, cookies);\n\n  var _React$useState = React.useState([]),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      activities = _React$useState2[0],\n      setActivities = _React$useState2[1];\n\n  var _React$useState3 = React.useState(true),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      loading = _React$useState4[0],\n      setLoading = _React$useState4[1];\n\n  var _React$useState5 = React.useState(1),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      pageState = _React$useState6[0],\n      setPageState = _React$useState6[1];\n\n  var _React$useState7 = React.useState(\"\"),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      nextPageUrl = _React$useState8[0],\n      setNextPageUrl = _React$useState8[1];\n\n  var _React$useState9 = React.useState(\"\"),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      previousPageUrl = _React$useState10[0],\n      setPreviousPageUrl = _React$useState10[1];\n\n  var _React$useState11 = React.useState(true),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      isFirstPage = _React$useState12[0],\n      setIsFirstPage = _React$useState12[1];\n\n  var currentTime = Date.now() / 1000;\n  var access_token = value.cookies.access_token;\n  React.useEffect(function () {\n    setLoading(true);\n\n    if (cookies.access_token) {\n      // do nothing\n      if (page) {\n        activitiesFetchUrl = \"https://www.strava.com/api/v3/athlete/activities?per_page=30&page=\" + page;\n        setNextPageUrl(\"/activities?page=\" + (Number(page) + 1));\n        setIsFirstPage(false);\n\n        if (page >= 2) {\n          setPreviousPageUrl(\"/activities?page=\" + (Number(page) - 1));\n        } else if (page == 1) {\n          setPreviousPageUrl(\"/activities\");\n          setIsFirstPage(true);\n        }\n      } else {\n        activitiesFetchUrl = \"https://www.strava.com/api/v3/athlete/activities?per_page=30&page=1\";\n        setNextPageUrl(\"/activities?page=\" + 2);\n        setIsFirstPage(true);\n      }\n\n      fetch(activitiesFetchUrl, {\n        method: \"get\",\n        headers: {\n          \"content-type\": \"application/json\",\n          authorization: \"Bearer \" + access_token\n        }\n      }).then(function (response) {\n        return response.json();\n      }).then(function (json) {\n        console.log(\"ACTIVITIES: data fetched\");\n        setActivities(json);\n        setLoading(false);\n      });\n    } else {\n      console.log(\"ACTIVITIES: No Auth\");\n      Router.push(\"/\");\n    }\n  }, [auth, page]);\n  var parentVariants = {\n    show: {\n      opacity: 1,\n      transition: {\n        staggerChildren: 0.05\n      }\n    },\n    hide: {\n      opacity: 0\n    }\n  };\n  var childrenVariants = {\n    show: {\n      y: 0,\n      opacity: 1,\n      scale: 1,\n      rotateX: 0,\n      transition: {\n        type: \"spring\",\n        stiffness: 800,\n        damping: 40\n      }\n    },\n    hide: {\n      y: 70,\n      opacity: 0,\n      scale: 0.9,\n      rotateX: -45\n    }\n  };\n  var ActivitiesPaginator = styled.div.withConfig({\n    displayName: \"pages__ActivitiesPaginator\",\n    componentId: \"sc-38y5yx-1\"\n  })([\"margin-top:\", \";margin-bottom:\", \";text-align:center;display:flex;justify-content:flex-start;a{flex-grow:50%;&:first-of-type{padding-right:\", \";}}\"], function (props) {\n    return props.theme.tokens.spacing.L.value;\n  }, function (props) {\n    return props.theme.tokens.spacing.L.value;\n  }, function (props) {\n    return props.theme.tokens.spacing.S.value;\n  });\n  return __jsx(Wrapper, {\n    props: props\n  }, __jsx(Container, null, __jsx(SubNav, null), __jsx(\"div\", null, __jsx(PageHeader, null, \"All Activities\"), loading ? __jsx(motion.div, {\n    exit: {\n      opacity: 0\n    }\n  }, __jsx(Skeleton, null)) : __jsx(AnimatePresence, null, __jsx(motion.div, {\n    exit: {\n      opacity: 0\n    },\n    initial: \"hide\",\n    variants: parentVariants,\n    animate: \"show\"\n  }, __jsx(ActivitiesGrid, null, activities.map(function (activity) {\n    return __jsx(motion.div, {\n      key: activity.id,\n      variants: childrenVariants,\n      initial: \"hide\",\n      exit: {\n        opacity: 0\n      }\n    }, __jsx(ActivityCard, {\n      activity: activity,\n      user: props.user\n    }));\n  })), __jsx(ActivitiesPaginator, null, isFirstPage ? \"\" : __jsx(Link, {\n    href: previousPageUrl,\n    as: previousPageUrl\n  }, __jsx(\"a\", null, __jsx(Button, {\n    label: \"← Previous page\"\n  }))), __jsx(Link, {\n    href: nextPageUrl,\n    as: nextPageUrl\n  }, __jsx(\"a\", null, __jsx(Button, {\n    label: \"Next page →\"\n  })))))))));\n};\n\nexport default Activities;","map":null,"metadata":{},"sourceType":"module"}