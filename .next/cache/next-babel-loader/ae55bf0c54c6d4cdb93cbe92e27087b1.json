{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\nimport Wrapper from \"../../components/layout/wrapper\";\nimport fetch from \"isomorphic-unfetch\";\nimport React from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport styled from \"styled-components\";\nimport ActivityCard from \"../../components/activity-card\";\nimport { AuthContext } from \"../_app\";\nimport Router, { useRouter } from \"next/router\";\nimport Skeleton from \"../../components/skeleton\";\nimport { Container } from \"../../components/layout/container\";\nimport { PageHeader } from \"../../components/pageHeader\";\nimport SubNav from \"../../components/subnav\";\nimport Link from \"next/link\";\nimport { Button } from \"../../components/button\";\nvar ActivitiesGrid = styled.div.withConfig({\n  displayName: \"activities__ActivitiesGrid\",\n  componentId: \"sc-1uaw2n7-0\"\n})([\"display:grid;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));grid-gap:\", \";@media (max-width:\", \"){grid-template-columns:1fr;}\"], function (props) {\n  return props.theme.tokens.spacing.L.value;\n}, function (props) {\n  return props.theme.tokens.mediaQueries.small;\n});\nvar activitiesFetchUrl;\n\nvar Activities = function Activities(props) {\n  // const { cookies } = props;\n  var router = useRouter();\n  var page = router.query.page;\n  var auth = props.auth;\n  var value = React.useContext(AuthContext);\n  var cookies = value.cookies;\n\n  var _React$useState = React.useState([]),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      activities = _React$useState2[0],\n      setActivities = _React$useState2[1];\n\n  var _React$useState3 = React.useState(true),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      loading = _React$useState4[0],\n      setLoading = _React$useState4[1];\n\n  var _React$useState5 = React.useState(1),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      pageState = _React$useState6[0],\n      setPageState = _React$useState6[1];\n\n  var _React$useState7 = React.useState(\"\"),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      nextPageUrl = _React$useState8[0],\n      setNextPageUrl = _React$useState8[1];\n\n  var _React$useState9 = React.useState(\"\"),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      previousPageUrl = _React$useState10[0],\n      setPreviousPageUrl = _React$useState10[1];\n\n  var _React$useState11 = React.useState(true),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      isFirstPage = _React$useState12[0],\n      setIsFirstPage = _React$useState12[1];\n\n  var currentTime = Date.now() / 1000;\n  var access_token = value.cookies.access_token;\n  React.useEffect(function () {\n    if (cookies.access_token) {\n      // do nothing\n      if (page) {\n        activitiesFetchUrl = \"https://www.strava.com/api/v3/athlete/activities?per_page=30&page=\" + page;\n        setNextPageUrl(\"/activities?page=\" + (Number(page) + 1));\n        setIsFirstPage(false);\n\n        if (page >= 2) {\n          setPreviousPageUrl(\"/activities?page=\" + (Number(page) - 1));\n        } else if (page == 1) {\n          setPreviousPageUrl(\"/activities\");\n          setIsFirstPage(true);\n        }\n      } else {\n        activitiesFetchUrl = \"https://www.strava.com/api/v3/athlete/activities?per_page=30&page=1\";\n        setNextPageUrl(\"/activities?page=\" + 2);\n        setIsFirstPage(true);\n      }\n\n      fetch(activitiesFetchUrl, {\n        method: \"get\",\n        headers: {\n          \"content-type\": \"application/json\",\n          authorization: \"Bearer \" + access_token\n        }\n      }).then(function (response) {\n        return response.json();\n      }).then(function (json) {\n        // console.log(\"ACTIVITIES: data fetched\");\n        setActivities(json);\n        setLoading(false);\n      });\n    } else {\n      // console.log(\"ACTIVITIES: No Auth\");\n      Router.push(\"/\");\n    }\n  }, [auth, page, value]);\n  var parentVariants = {\n    show: {\n      opacity: 1,\n      transition: {\n        staggerChildren: 0.05\n      }\n    },\n    hide: {\n      opacity: 0\n    }\n  };\n  var childrenVariants = {\n    show: {\n      y: 0,\n      opacity: 1,\n      scale: 1,\n      rotateX: 0,\n      transition: {\n        type: \"spring\",\n        stiffness: 800,\n        damping: 40\n      }\n    },\n    hide: {\n      y: 70,\n      opacity: 0,\n      scale: 0.9,\n      rotateX: -45\n    }\n  };\n  var ActivitiesPaginator = styled.div.withConfig({\n    displayName: \"activities__ActivitiesPaginator\",\n    componentId: \"sc-1uaw2n7-1\"\n  })([\"margin-top:\", \";margin-bottom:\", \";text-align:center;display:flex;justify-content:flex-start;a{flex-grow:50%;&:first-of-type{padding-right:\", \";}}\"], function (props) {\n    return props.theme.tokens.spacing.L.value;\n  }, function (props) {\n    return props.theme.tokens.spacing.L.value;\n  }, function (props) {\n    return props.theme.tokens.spacing.S.value;\n  });\n  return __jsx(Wrapper, {\n    props: props\n  }, __jsx(Container, null, __jsx(SubNav, null), __jsx(\"div\", null, __jsx(PageHeader, null, \"All Activities\"), loading ? __jsx(motion.div, {\n    exit: {\n      opacity: 0\n    }\n  }, __jsx(Skeleton, null)) : __jsx(AnimatePresence, null, __jsx(motion.div, {\n    exit: {\n      opacity: 0\n    },\n    initial: \"hide\",\n    variants: parentVariants,\n    animate: \"show\"\n  }, __jsx(ActivitiesGrid, null, activities.map(function (activity) {\n    return __jsx(motion.div, {\n      key: activity.id,\n      variants: childrenVariants,\n      initial: \"hide\",\n      exit: {\n        opacity: 0\n      }\n    }, __jsx(ActivityCard, {\n      activity: activity,\n      user: props.user\n    }));\n  })), __jsx(ActivitiesPaginator, null, isFirstPage ? \"\" : __jsx(Link, {\n    href: previousPageUrl,\n    as: previousPageUrl\n  }, __jsx(\"a\", null, __jsx(Button, {\n    label: \"← Previous page\"\n  }))), __jsx(Link, {\n    href: nextPageUrl,\n    as: nextPageUrl\n  }, __jsx(\"a\", null, __jsx(Button, {\n    label: \"Next page →\"\n  })))))))));\n};\n\nexport default Activities;","map":null,"metadata":{},"sourceType":"module"}