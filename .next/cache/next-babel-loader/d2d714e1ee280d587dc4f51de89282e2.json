{"ast":null,"code":"var __jsx = React.createElement;\nimport Wrapper from \"../../components/layout/wrapper\";\nimport fetch from \"isomorphic-unfetch\";\nimport React from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport styled from \"styled-components\";\nimport ActivityCard from \"../../components/activity-card\";\nimport { AuthContext } from \"../_app\";\nimport Router, { useRouter } from \"next/router\";\nimport Skeleton from \"../../components/skeleton\";\nimport { Container } from \"../../components/layout/container\";\nimport { PageHeader } from \"../../components/pageHeader\";\nimport SubNav from \"../../components/subnav\";\nimport Link from \"next/link\";\nimport { Button } from \"../../components/button\";\nconst ActivitiesGrid = styled.div.withConfig({\n  displayName: \"activities__ActivitiesGrid\",\n  componentId: \"sc-1uaw2n7-0\"\n})([\"display:grid;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));grid-gap:\", \";@media (max-width:\", \"){grid-template-columns:1fr;}\"], props => props.theme.tokens.spacing.L.value, props => props.theme.tokens.mediaQueries.small);\nlet activitiesFetchUrl;\n\nconst Activities = props => {\n  // const { cookies } = props;\n  const router = useRouter();\n  const {\n    page\n  } = router.query;\n  const {\n    auth\n  } = props;\n  const value = React.useContext(AuthContext);\n  const cookies = value.cookies;\n  let [activities, setActivities] = React.useState([]);\n  let [loading, setLoading] = React.useState(true);\n  let [pageState, setPageState] = React.useState(1);\n  let [nextPageUrl, setNextPageUrl] = React.useState(\"\");\n  let [previousPageUrl, setPreviousPageUrl] = React.useState(\"\");\n  let [isFirstPage, setIsFirstPage] = React.useState(true);\n  let currentTime = Date.now() / 1000;\n  let access_token = value.cookies.access_token;\n  React.useEffect(() => {\n    if (cookies.access_token) {\n      // do nothing\n      if (page) {\n        activitiesFetchUrl = \"https://www.strava.com/api/v3/athlete/activities?per_page=30&page=\" + page;\n        setNextPageUrl(\"/activities?page=\" + (Number(page) + 1));\n        setIsFirstPage(false);\n\n        if (page >= 2) {\n          setPreviousPageUrl(\"/activities?page=\" + (Number(page) - 1));\n        } else if (page == 1) {\n          setPreviousPageUrl(\"/activities\");\n          setIsFirstPage(true);\n        }\n      } else {\n        activitiesFetchUrl = \"https://www.strava.com/api/v3/athlete/activities?per_page=30&page=1\";\n        setNextPageUrl(\"/activities?page=\" + 2);\n        setIsFirstPage(true);\n      }\n\n      fetch(activitiesFetchUrl, {\n        method: \"get\",\n        headers: {\n          \"content-type\": \"application/json\",\n          authorization: \"Bearer \" + access_token\n        }\n      }).then(function (response) {\n        return response.json();\n      }).then(json => {\n        // console.log(\"ACTIVITIES: data fetched\");\n        setActivities(json);\n        setLoading(false);\n      });\n    } else {\n      // console.log(\"ACTIVITIES: No Auth\");\n      Router.push(\"/\");\n    }\n  }, [auth, page, value]);\n  let parentVariants = {\n    show: {\n      opacity: 1,\n      transition: {\n        staggerChildren: 0.05\n      }\n    },\n    hide: {\n      opacity: 0\n    }\n  };\n  let childrenVariants = {\n    show: {\n      y: 0,\n      opacity: 1,\n      scale: 1,\n      rotateX: 0,\n      transition: {\n        type: \"spring\",\n        stiffness: 800,\n        damping: 40\n      }\n    },\n    hide: {\n      y: 70,\n      opacity: 0,\n      scale: 0.9,\n      rotateX: -45\n    }\n  };\n  let ActivitiesPaginator = styled.div.withConfig({\n    displayName: \"activities__ActivitiesPaginator\",\n    componentId: \"sc-1uaw2n7-1\"\n  })([\"margin-top:\", \";margin-bottom:\", \";text-align:center;display:flex;justify-content:flex-start;a{flex-grow:50%;&:first-of-type{padding-right:\", \";}}\"], props => props.theme.tokens.spacing.L.value, props => props.theme.tokens.spacing.L.value, props => props.theme.tokens.spacing.S.value);\n  return __jsx(Wrapper, {\n    props: props\n  }, __jsx(Container, null, __jsx(SubNav, null), __jsx(\"div\", null, __jsx(PageHeader, null, \"All Activities\"), loading ? __jsx(motion.div, {\n    exit: {\n      opacity: 0\n    }\n  }, __jsx(Skeleton, null)) : __jsx(AnimatePresence, null, __jsx(motion.div, {\n    exit: {\n      opacity: 0\n    },\n    initial: \"hide\",\n    variants: parentVariants,\n    animate: \"show\"\n  }, __jsx(ActivitiesGrid, null, activities.map(activity => __jsx(motion.div, {\n    key: activity.id,\n    variants: childrenVariants,\n    initial: \"hide\",\n    exit: {\n      opacity: 0\n    }\n  }, __jsx(ActivityCard, {\n    activity: activity,\n    user: props.user\n  })))), __jsx(ActivitiesPaginator, null, isFirstPage ? \"\" : __jsx(Link, {\n    href: previousPageUrl,\n    as: previousPageUrl\n  }, __jsx(\"a\", null, __jsx(Button, {\n    label: \"← Previous page\"\n  }))), __jsx(Link, {\n    href: nextPageUrl,\n    as: nextPageUrl\n  }, __jsx(\"a\", null, __jsx(Button, {\n    label: \"Next page →\"\n  })))))))));\n};\n\nexport default Activities;","map":null,"metadata":{},"sourceType":"module"}